(self.webpackChunkSUN_crm=self.webpackChunkSUN_crm||[]).push([[944],{98944:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>L});var n=o(65043),l=o(50289),a=o(48193),s=o(64435),r=o(47419),d=o(11645),i=o(94406),u=o(89421),c=o(5397),f=o(59888),p=o(82907),v=o(74954),h=o(64124),m=o(96066),b=o(60184),x=o(92528),g=o(67407),A=o(49422),I=o(70579);const j={status:null},w=e=>{let{data:t,refetch:o,setPdfId:c,setIsLoadingPdf:w}=e;const{user:y}=(0,A.Z)(),[C]=l.A.useForm(),[E,S]=(0,n.useState)(!1),[L,k]=(0,n.useState)(null),{mutate:F,data:U,isLoading:M,isSuccess:R}=(0,p.useMutation)((e=>{let{url:t,data:o,id:n}=e;return f.A.editData(t,o,n)}),{onSuccess:()=>{a.Ay.success("Success")},onError:e=>{for(let t in e.response.data)a.Ay.error("".concat(t,": ").concat(e.response.data[t][0]))}}),D=e=>{F({url:"/Apartment/SelerUpdate",data:e,id:L})};(0,n.useEffect)((()=>{R&&(S(!1),C.setFieldsValue(j),o())}),[U]);const H=(0,n.useMemo)((()=>{const e=[{value:1,label:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e"},{value:2,label:"\u0417\u0430\u043d\u044f\u0442\u043e"}];return"admin"===y.role[1]&&e.push({value:3,label:"\u041f\u0440\u043e\u0434\u0430\u043d\u043e"}),e}),[]),O=[{title:"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430",dataIndex:"name",id:"name",render:e=>(0,I.jsx)("p",{children:e})},{title:"\u041f\u043b\u043e\u0449\u0430\u0434\u044c",dataIndex:"size",id:"size",render:e=>(0,I.jsxs)("p",{children:[e,"\u043c\xb2"]})},{title:"\u041a\u043e\u043c\u043d\u0430\u0442\u044b",dataIndex:"roomCount",id:"roomCount",render:e=>(0,I.jsx)("p",{children:e})},{title:"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c",dataIndex:"price",id:"price",render:e=>(0,I.jsxs)("p",{children:[e,"$"]})},{title:"\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435",dataIndex:"status",id:"status",render:(e,t)=>(0,I.jsx)(u.A,{onClick:()=>{return e=t.id,S(!0),void k(e);var e},style:{backgroundColor:1===e?"green":2===e?"#f7ff00":"#ff0000",color:1===e?"#fff":2===e?"#000000":"#fff"},icon:(0,I.jsx)(g.A,{}),children:1===e?"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e":2===e?"\u0417\u0430\u043d\u044f\u0442\u043e":"\u041f\u0440\u043e\u0434\u0430\u043d\u043e"})},{title:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043a\u0432\u0430\u0440\u0442\u0438\u0440\u044b",dataIndex:"homeImage",id:"homeImage",render:e=>(0,I.jsx)(v.A,{width:50,src:"".concat("https://seller.human2human.uz/","/").concat(null===e||void 0===e?void 0:e.path)})},{title:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u044d\u0442\u0430\u0436",dataIndex:"floorImage",id:"floorImage",render:e=>(0,I.jsx)(v.A,{width:50,src:"".concat("https://seller.human2human.uz/","/").concat(null===e||void 0===e?void 0:e.path)})},{title:"PDF",id:"action",render:(e,t)=>(0,I.jsx)(s.A,{size:20,children:(0,I.jsx)(u.A,{disabled:3===t.status,onClick:()=>{return e=t.id,c(e),void w(!0);var e},icon:(0,I.jsx)(b.kl1,{}),style:{backgroundColor:"#FF5B00"}})})}];return(0,I.jsxs)("div",{children:[(0,I.jsx)(h.A,{title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439",open:E,onOk:()=>{C.validateFields().then((e=>{D(e)})).catch((e=>{console.log("Failed:",e)}))},onCancel:()=>{S(!1)},children:M?(0,I.jsx)(x.HE,{}):(0,I.jsx)(l.A,{form:C,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:j,onFinish:D,autoComplete:"off",children:(0,I.jsx)(r.A,{gutter:20,children:(0,I.jsx)(d.A,{span:24,children:(0,I.jsx)(l.A.Item,{label:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0434\u043e\u043c\u0430",name:"status",rules:[{required:!0,message:"\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435"}],wrapperCol:{span:24},children:(0,I.jsx)(i.A,{style:{width:"100%"},placeholder:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0434\u043e\u043c\u0430",optionLabelProp:"label",options:H})})})})})}),(0,I.jsx)(m.A,{columns:O,dataSource:t,rowKey:e=>e.id})]})};var y=o(83002),C=o(52032),E=o(49730),S=o(72450);const L=()=>{const[e]=l.A.useForm(),[t,o]=(0,n.useState)(""),[v,h]=(0,n.useState)({slotId:null,houseId:null,floorId:null}),[m,b]=(0,n.useState)(null),[x,g]=(0,n.useState)(!1),{data:A,refetch:j,isSuccess:L}=(0,p.useQuery)("get-pdf",(()=>f.A.getDataByID("/PdfData",m)),{enabled:!1}),{data:k,refetch:F}=(0,p.useQuery)("get-slot",(()=>f.A.getData("/Slot")),{enabled:!1}),{data:U,refetch:M}=(0,p.useQuery)("get-house",(()=>f.A.getData("/House?slotId=".concat(null===v||void 0===v?void 0:v.slotId))),{enabled:!1}),{data:R,refetch:D,remove:H}=(0,p.useQuery)("get-floor",(()=>f.A.getData("/Floor?housId=".concat(null===v||void 0===v?void 0:v.houseId))),{enabled:!1}),{data:O,isLoading:P,refetch:T}=(0,p.useQuery)("selling-apartment-get",(()=>f.A.getData("/Apartment/?".concat(t?"status=".concat(t):"").concat(null!==v&&void 0!==v&&v.slotId?"&SlotId=".concat(null===v||void 0===v?void 0:v.slotId):"").concat(null!==v&&void 0!==v&&v.houseId?"&HouseId=".concat(null===v||void 0===v?void 0:v.houseId):"").concat(null!==v&&void 0!==v&&v.floorId?"&FlorId=".concat(null===v||void 0===v?void 0:v.floorId):""))),{enabled:!1,onError:e=>{a.Ay.error(e)}});(0,n.useEffect)((()=>{L&&m&&(0,C.x8)((0,I.jsx)(E.A,{data:A})).toBlob().then((e=>{g(!1),b(null),(0,S.saveAs)(e,"SUN-Human2Human.pdf")}))}),[A]),(0,n.useEffect)((()=>{m&&j()}),[m]),(0,n.useEffect)((()=>{F()}),[]),(0,n.useEffect)((()=>{null!==v&&void 0!==v&&v.slotId&&M()}),[null===v||void 0===v?void 0:v.slotId]),(0,n.useEffect)((()=>{null!==v&&void 0!==v&&v.houseId&&D()}),[null===v||void 0===v?void 0:v.houseId]),(0,n.useEffect)((()=>{T()}),[t,v]);const B=(0,n.useMemo)((()=>[{value:"",label:"\u0412\u0441\u0435"},{value:1,label:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e"},{value:2,label:"\u0417\u0430\u043d\u044f\u0442\u043e"},{value:3,label:"\u041f\u0440\u043e\u0434\u0430\u043d\u043e"}]),[]);(0,n.useEffect)((()=>{var e;k&&h({slotId:null===k||void 0===k||null===(e=k.result[0])||void 0===e?void 0:e.id,houseId:null,floorId:null})}),[k]);const z=(0,n.useMemo)((()=>{var e;return null===U||void 0===U||null===(e=U.result)||void 0===e?void 0:e.map((e=>({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.name})))}),[U]),Q=(0,n.useMemo)((()=>{var e;return null===R||void 0===R||null===(e=R.result)||void 0===e?void 0:e.map((e=>({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.name})))}),[R]);return(0,I.jsx)("div",{className:"site-space-compact-wrapper",children:(0,I.jsxs)(s.A,{direction:"vertical",style:{width:"100%"},children:[(0,I.jsx)(l.A,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},autoComplete:"off",children:(0,I.jsxs)(r.A,{gutter:20,children:[(0,I.jsx)(d.A,{span:6,children:(0,I.jsx)(l.A.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u043e\u043c",name:"houseId",wrapperCol:{span:24},children:(0,I.jsx)(i.A,{style:{width:"100%"},optionLabelProp:"label",onChange:t=>{e.setFieldsValue({floorId:null}),h((e=>({...e,houseId:t,floorId:null})))},options:z})})}),(0,I.jsx)(d.A,{span:6,children:(0,I.jsx)(l.A.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u044d\u0442\u0430\u0436",name:"floorId",wrapperCol:{span:24},children:(0,I.jsx)(i.A,{style:{width:"100%"},optionLabelProp:"label",options:Q,onChange:e=>{h((t=>({...t,floorId:e})))}})})}),(0,I.jsx)(d.A,{span:6,children:(0,I.jsx)(l.A.Item,{label:"\u0424\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443",name:"status",wrapperCol:{span:24},children:(0,I.jsx)(i.A,{style:{width:"100%"},optionLabelProp:"label",onChange:e=>{o(e)},options:B})})}),(0,I.jsx)(d.A,{span:6,children:(0,I.jsx)(l.A.Item,{label:" \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430",name:"",wrapperCol:{span:24},children:(0,I.jsx)(u.A,{htmlType:"button",type:"dashed",icon:(0,I.jsx)(y.UCj,{}),style:{width:"100%",color:"red"},onClick:()=>{e.setFieldsValue({slotId:null,houseId:null,floorId:null,status:""}),h((e=>({...e,houseId:null,floorId:null}))),o(""),H()},children:"\u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430"})})})]})}),(0,I.jsx)(c.A,{size:"medium",spinning:P||x,children:(0,I.jsx)(w,{data:null===O||void 0===O?void 0:O.result,refetch:T,setPdfId:b,setIsLoadingPdf:g})})]})})}},72450:function(e,t,o){var n,l,a;l=[],void 0===(a="function"===typeof(n=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,o){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){d(n.response,t,o)},n.onerror=function(){console.error("could not download file")},n.send()}function l(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof o.g&&o.g.global===o.g?o.g:void 0,r=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(e,t,o){var r=s.URL||s.webkitURL,d=document.createElement("a");t=t||e.name||"download",d.download=t,d.rel="noopener","string"==typeof e?(d.href=e,d.origin===location.origin?a(d):l(d.href)?n(e,t,o):a(d,d.target="_blank")):(d.href=r.createObjectURL(e),setTimeout((function(){r.revokeObjectURL(d.href)}),4e4),setTimeout((function(){a(d)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,o,s){if(o=o||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,s),o);else if(l(e))n(e,o,s);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout((function(){a(r)}))}}:function(e,t,o,l){if((l=l||open("","_blank"))&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,o);var a="application/octet-stream"===e.type,d=/constructor/i.test(s.HTMLElement)||s.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||a&&d||r)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=e:location=e,l=null},u.readAsDataURL(e)}else{var c=s.URL||s.webkitURL,f=c.createObjectURL(e);l?l.location=f:location.href=f,l=null,setTimeout((function(){c.revokeObjectURL(f)}),4e4)}});s.saveAs=d.saveAs=d,e.exports=d})?n.apply(t,l):n)||(e.exports=a)}}]);
//# sourceMappingURL=944.7c80ffeb.chunk.js.map